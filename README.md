# Spring Boot 2 SSL Demo

Simple working example spring boot 2 with http and https enabled protocols, and keytool plugin to generate pair

## Getting Started

This Maven proyect has 2 profiles: DEV (usefull for local and dev environments) and Prod. 
DEV: start up HTTP (8080) and HTTPS(8443, using keytool maven plugin to autogenerate keystore and cert). And remote debug available on 5005.
PROD:only runs on HTTPS, using an external provided keystore. If you want to autogenerate , exist a script /profiles/prod/createKeyStoreWithCert.sh that will generate a external keystore. After that you can edit /profiles/prod/application.properties and set data properties to configure HTTPS for the new Keystore

### Prerequisites

Maven project, Java JDK 8 or higher

## Profile DEV

This profile start the Http(8080) and Https(8443) Connectors. To perform HTTPS connector, the keytool maven plugin is executed on generate-resources phase.
Generated cert is based on pom profile property <ssl.keytool.cert.sitename>myamazingapp-dev.com</ssl.keytool.cert.sitename>, 
So keytool will generate a cert for ${ssl.keytool.cert.sitename} site, so you can add ssl.keytool.cert.sitename x.x.x.x to your /ect/hosts file  to avoid site Common Name Mismatch Error (ssl_error_bad_cert_domain)

```
###Build (execute keytool package the generated cert into the jar file)
${project.home}/ mvn clean install -P dev
```

```
###Start:(execute keytool package the generated cert into the jar file)
${project.home}/mvn clean spring-boot:run -P dev  (serve http:8080, https:8443 and remote debug available on 5005
```

```
###Start (from Eclipse): 
goto com.dppware.demossl.DemosslApplication Run As> Java Application
(ensure that the cert is available on /target/classes/keystore.dev.p12 or other classpath project directory. You can generate the cert using mvn clean keytool:generateKeyPair
```
### Customization DEV
In this profile 
if you want to use only https, edit ${project.home}/profiles/dev/application.properties and modify : 
```
server.http.enabled=false 
```
if you want to use only http, edit ${project.home}/profiles/dev/application.properties and modify :
```
remove all server.ssl.* properties
change server.port=8080
```


## Profile PROD
Usefull for production, using external cert, only https available

First edit /profiles/prod/application.properties file to set this properties based on your production keystore 
```
server.ssl.key-store=
server.ssl.key-store-password=
server.ssl.keyStoreType=
server.ssl.keyAlias=
```
If you want to test produccion with an autogenerated cert, you can generate your custom keystore with cert in this way:
cd /profiles/prod/createKeyStoreWithCert.sh   (you can edit it to generate custom data cert)
>./createKeyStoreWithCert.sh   this will generate ${project.home}/sites/myamazingapp/certs/amazingSiteProdkeystore-prod.p12 file



## Running the tests

Maven pahse integrated test


## Built With

* [JAVA]JDK 1.8- The web framework used
* [Maven](https://maven.apache.org/) - Dependency Management
* [KeyTool](https://docs.oracle.com/javase/7/docs/technotes/tools/solaris/keytool.html) - Used to generate Keystore and Certs

## Contributing

Please read [CONTRIBUTING.md](https://gist.github.com/PurpleBooth/b24679402957c63ec426) for details on our code of conduct, and the process for submitting pull requests to us.

## Versioning

We use [SemVer](http://semver.org/) for versioning. For the versions available, see the [tags on this repository](https://github.com/your/project/tags). 

## Authors

* **Daniel Pe√±a Perez** - *Initial work* - [PurpleBooth](https://github.com/danipenaperez)

See also the list of [contributors](https://github.com/your/project/contributors) who participated in this project.

## License

This project is licensed under the MIT License - see the [LICENSE.md](LICENSE.md) file for details

## Acknowledgments

* The Rayo Vallecano for all these years of glory
* Inspiration
* etc